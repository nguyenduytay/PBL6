{% extends "base.html" %} {% block title %}Dashboard - Malware Detector{%
endblock %} {% block page_title %}Dashboard{% endblock %} {% block content %}
<!-- Statistics Cards -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
  <!-- Total Analyses -->
  <div class="bg-white rounded-lg shadow-md p-6 border-l-4 border-primary">
    <div class="flex items-center justify-between">
      <div>
        <p class="text-gray-600 text-sm font-medium">Total Analyses</p>
        <p class="text-3xl font-bold text-gray-800 mt-2" id="total-analyses">
          0
        </p>
      </div>
      <div class="bg-primary bg-opacity-10 p-4 rounded-full">
        <i class="fas fa-file-alt text-2xl text-primary"></i>
      </div>
    </div>
  </div>

  <!-- Malware Detected -->
  <div class="bg-white rounded-lg shadow-md p-6 border-l-4 border-danger">
    <div class="flex items-center justify-between">
      <div>
        <p class="text-gray-600 text-sm font-medium">Malware Detected</p>
        <p class="text-3xl font-bold text-gray-800 mt-2" id="malware-count">
          0
        </p>
      </div>
      <div class="bg-danger bg-opacity-10 p-4 rounded-full">
        <i class="fas fa-virus text-2xl text-danger"></i>
      </div>
    </div>
  </div>

  <!-- Clean Files -->
  <div class="bg-white rounded-lg shadow-md p-6 border-l-4 border-secondary">
    <div class="flex items-center justify-between">
      <div>
        <p class="text-gray-600 text-sm font-medium">Clean Files</p>
        <p class="text-3xl font-bold text-gray-800 mt-2" id="clean-count">0</p>
      </div>
      <div class="bg-secondary bg-opacity-10 p-4 rounded-full">
        <i class="fas fa-check-circle text-2xl text-secondary"></i>
      </div>
    </div>
  </div>

  <!-- YARA Rules -->
  <div class="bg-white rounded-lg shadow-md p-6 border-l-4 border-warning">
    <div class="flex items-center justify-between">
      <div>
        <p class="text-gray-600 text-sm font-medium">YARA Rules</p>
        <p class="text-3xl font-bold text-gray-800 mt-2" id="yara-rules-count">
          564+
        </p>
      </div>
      <div class="bg-warning bg-opacity-10 p-4 rounded-full">
        <i class="fas fa-shield-alt text-2xl text-warning"></i>
      </div>
    </div>
  </div>
</div>

<!-- Charts Row -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
  <!-- Analysis Over Time -->
  <div class="bg-white rounded-lg shadow-md p-6">
    <h3 class="text-lg font-semibold text-gray-800 mb-4">
      <i class="fas fa-chart-line mr-2 text-primary"></i>
      Analysis Over Time
    </h3>
    <div class="chart-container">
      <canvas id="analysisChart"></canvas>
    </div>
  </div>

  <!-- Malware Types Distribution -->
  <div class="bg-white rounded-lg shadow-md p-6">
    <h3 class="text-lg font-semibold text-gray-800 mb-4">
      <i class="fas fa-chart-pie mr-2 text-primary"></i>
      Malware Types
    </h3>
    <div class="chart-container">
      <canvas id="malwareTypesChart"></canvas>
    </div>
  </div>
</div>

<!-- Recent Analyses -->
<div class="bg-white rounded-lg shadow-md">
  <div class="p-6 border-b border-gray-200">
    <div class="flex items-center justify-between">
      <h3 class="text-lg font-semibold text-gray-800">
        <i class="fas fa-history mr-2 text-primary"></i>
        Recent Analyses
      </h3>
      <a
        href="/analyses"
        class="text-primary hover:text-primary-dark text-sm font-medium"
      >
        View All <i class="fas fa-arrow-right ml-1"></i>
      </a>
    </div>
  </div>
  <div class="p-6">
    <div id="recent-analyses" class="space-y-4">
      <!-- Will be populated by JavaScript -->
      <div class="text-center text-gray-500 py-8">
        <i class="fas fa-inbox text-4xl mb-4"></i>
        <p>No analyses yet. Submit your first file to get started!</p>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block scripts %}
<script>
  // Initialize charts
  document.addEventListener("DOMContentLoaded", function () {
    // Analysis Over Time Chart
    const analysisCtx = document.getElementById("analysisChart");
    if (analysisCtx) {
      new Chart(analysisCtx, {
        type: "line",
        data: {
          labels: ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
          datasets: [
            {
              label: "Analyses",
              data: [0, 0, 0, 0, 0, 0, 0],
              borderColor: "#2563eb",
              backgroundColor: "rgba(37, 99, 235, 0.1)",
              tension: 0.4,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: false,
            },
          },
        },
      });
    }

    // Malware Types Chart
    const typesCtx = document.getElementById("malwareTypesChart");
    if (typesCtx) {
      new Chart(typesCtx, {
        type: "doughnut",
        data: {
          labels: ["Trojan", "Ransomware", "Virus", "Other"],
          datasets: [
            {
              data: [0, 0, 0, 0],
              backgroundColor: ["#ef4444", "#f59e0b", "#10b981", "#6b7280"],
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
        },
      });
    }

    // Update current time
    function updateTime() {
      const now = new Date();
      document.getElementById("current-time").textContent =
        now.toLocaleTimeString("vi-VN");
    }
    updateTime();
    setInterval(updateTime, 1000);
  });
</script>
{% endblock %}
